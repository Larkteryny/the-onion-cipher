"use strict" // Crashes hard

// Import functionality
const tf = require('@tensorflow/tfjs-node')
const fs = require('fs')

const ATTEMPT = 1


// Read dataset
var xs = [], ys = []
var val_xs = [], val_ys = [] // Validation sets to avoid overfitting

console.log("Reading JSON")
const contents = fs.readFileSync('do_not_touch_databomb/dataset.json', 'utf8')
const dataset = JSON.parse(contents)
console.log("JSON read")
console.log(dataset.length)

for (const pair of dataset.splice(0, 1000)) {
  val_xs.push(pair.val)
  val_ys.push(pair.label)
}
val_xs = tf.tensor(val_xs)
val_ys = tf.tensor(val_ys)
for (const pair of dataset) { // .splice() is mutating, so dataset no longer has first 1000 datapoints
  xs.push(pair.val)
  ys.push(pair.label)
}
xs = tf.tensor(xs)
ys = tf.tensor(ys)

// Build model
const model = tf.sequential({
  layers: [
    tf.layers.dense({inputShape: [100], units: 100, activation: 'relu'}),
    tf.layers.dense({units: 100, activation: 'relu'}),
    tf.layers.dense({units: 50, activation: 'relu'}),
    tf.layers.dense({units: 11, activation: 'sigmoid', biasRegularizer: tf.regularizers.l2()}),
  ]
});

// Compile model
const optimizer = tf.train.adam(0.001)
model.compile({
  optimizer,
  loss: "meanSquaredError",
  metrics: ['accuracy']
});

const tests = [
[
   0.765625, 0.8515625,   0.78125,      0.25,   0.78125, 0.828125,    0.9375,
       0.25,  0.609375,      0.25,  0.796875,  0.890625,     0.25,  0.796875,
       0.25, 0.8984375,  0.828125,  0.953125, 0.9296875,  0.90625, 0.8984375,
       0.25,  0.828125, 0.8984375, 0.8671875,   0.90625,  0.78125,  0.828125,
  0.9296875,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0,         0,         0,         0,        0,         0,
          0,         0
],
[
  0.828125,   0.84375, 0.8984375,      0.25,     0.875, 0.8984375,  0.796875,
      0.25,  0.671875,      0.25, 0.7890625, 0.8046875,      0.25,  0.890625,
      0.25,  0.765625,  0.890625,    0.8125,  0.921875, 0.8203125, 0.7890625,
      0.25, 0.8984375, 0.7578125, 0.9296875, 0.8984375, 0.8984375,  0.921875,
  0.796875,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,
         0,         0
],
[
  0.5859375, 0.6640625,  0.359375,      0.25,  0.046875,  1.046875, 1.8984375,
  1.1796875,   1.40625, 0.4609375, 0.2734375, 0.5390625, 0.5859375,   1.59375,
  1.5234375,  0.890625, 0.8515625,  1.046875,  1.296875, 1.3671875, 1.5859375,
          1, 0.7734375,  1.828125, 0.9609375,  0.609375, 0.3828125, 1.0234375,
  1.3515625,  0.390625, 1.4140625, 0.1328125,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0
],
[
  0.4296875, 0.3828125,  0.765625, 0.3828125,  0.421875, 0.4453125,
   0.765625,  0.765625,     0.375,  0.765625,   0.40625, 0.4140625,
   0.390625, 0.4140625, 0.7890625, 0.3984375,  0.390625,  0.390625,
  0.3828125, 0.4453125, 0.3984375,   0.78125,   0.40625, 0.4140625,
  0.4140625, 0.4140625, 0.4140625, 0.4453125, 0.3984375,  0.765625,
  0.7890625, 0.7890625, 0.3828125,  0.421875, 0.4296875, 0.7734375,
    0.78125, 0.4453125, 0.4453125,  0.421875,  0.421875,   0.40625,
  0.3828125,    0.4375, 0.4140625, 0.3828125,  0.390625,  0.421875,
   0.390625, 0.7734375,  0.390625,  0.421875, 0.7890625,   0.40625,
   0.796875, 0.3828125, 0.4453125,   0.40625,  0.390625,  0.390625,
  0.4140625, 0.4296875,     0.375, 0.4296875,         0,         0,
          0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,
          0,         0,         0,         0
],
[
   0.765625,     0.375,   0.78125, 0.4296875, 0.4296875,     0.375,   0.78125,
    0.40625,    0.4375, 0.7890625,  0.765625, 0.7734375,  0.421875, 0.4296875,
    0.40625, 0.4296875,  0.796875, 0.4296875,  0.796875,   0.40625, 0.4140625,
     0.4375,    0.4375, 0.4140625,     0.375,   0.78125, 0.4296875,  0.390625,
   0.421875,  0.421875,  0.765625, 0.4296875, 0.4140625, 0.7734375, 0.4140625,
  0.4296875,  0.796875,    0.4375,     0.375, 0.7734375,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0
],
[
   0.421875,  0.796875,  0.796875,  0.765625, 0.3984375, 0.3984375,    0.4375,
  0.4453125,   0.78125,  0.390625, 0.4140625, 0.7890625, 0.7734375, 0.4296875,
   0.765625,  0.796875,     0.375, 0.3984375, 0.7890625,     0.375, 0.4296875,
  0.4140625, 0.3984375, 0.7578125, 0.3828125,  0.390625, 0.4296875, 0.4140625,
  0.7890625, 0.3984375,  0.796875,   0.40625,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0
],
[
    0.78125,  0.390625,    0.8125, 0.4140625, 0.5703125,    0.5625,   0.84375,
    0.84375, 0.7734375, 0.9453125,  0.515625,  0.578125, 0.5703125, 0.5546875,
   0.546875,   0.90625, 0.5703125, 0.5546875, 0.5390625, 0.8046875,  0.765625,
  0.8515625,  0.671875, 0.3828125, 0.7734375, 0.8515625, 0.4453125, 0.9140625,
  0.5703125, 0.5546875,  0.671875, 0.9140625, 0.7578125, 0.8515625, 0.4453125,
  0.4140625,  0.703125,    0.6875, 0.5703125, 0.4765625,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0
],
[
     0.6875, 0.3671875,   0.96875, 0.3515625,   0.96875, 0.6953125,     0.25,
  0.6953125, 0.3984375, 0.4140625,      0.25, 0.2578125,      0.25,  0.40625,
    0.96875,  0.671875,   0.96875,      0.25,   0.40625,      0.25,  0.96875,
    0.96875, 0.3984375,    0.3125, 0.7421875, 0.3203125,   0.96875, 0.390625,
      0.375,   0.96875,   0.96875,      0.25, 0.3984375,   0.96875,  0.96875,
   0.578125,     0.375, 0.6953125, 0.3984375,   0.96875,  0.390625,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0,         0,         0,         0,         0,        0,
          0,         0
],
[
   0.359375, 0.3515625, 0.3515625,      0.25,  0.359375,  0.359375,
   0.359375,  0.359375,      0.25, 0.3515625,  0.359375, 0.3515625,
  0.3515625,      0.25, 0.3671875,      0.25, 0.3515625,  0.359375,
  0.3515625, 0.3515625,      0.25,  0.359375,      0.25,  0.359375,
   0.359375,  0.359375,      0.25, 0.3671875,      0.25,  0.359375,
   0.359375,      0.25, 0.3671875,      0.25,  0.359375, 0.3515625,
       0.25, 0.3515625, 0.3515625,      0.25, 0.3671875,      0.25,
   0.359375, 0.3515625,      0.25, 0.3671875,      0.25, 0.3515625,
   0.359375,      0.25,  0.359375,      0.25,  0.359375,  0.359375,
  0.3515625,      0.25,  0.359375, 0.3515625,  0.359375,      0.25,
  0.3515625, 0.3515625, 0.3515625,      0.25, 0.3515625,  0.359375,
       0.25, 0.3671875,      0.25,  0.359375,      0.25, 0.3515625,
   0.359375,      0.25,  0.359375, 0.3515625, 0.3515625, 0.3515625,
       0.25, 0.3515625, 0.3515625, 0.3515625,      0.25, 0.3515625,
   0.359375, 0.3515625, 0.3515625,      0.25,  0.359375,      0.25,
   0.359375, 0.3515625,  0.359375,         0,         0,         0,
          0,         0,         0,         0
],
[
  0.3828125, 0.3828125, 0.3828125,     0.375, 0.3828125, 0.3828125,
  0.3828125, 0.3828125, 0.3828125,     0.375, 0.3828125,     0.375,
      0.375,     0.375, 0.3828125, 0.3828125, 0.3828125, 0.3828125,
      0.375,     0.375, 0.3828125, 0.3828125,     0.375,     0.375,
      0.375,     0.375,     0.375, 0.3828125, 0.3828125, 0.3828125,
  0.3828125,     0.375,     0.375, 0.3828125, 0.3828125, 0.3828125,
      0.375,     0.375, 0.3828125,     0.375, 0.3828125, 0.3828125,
  0.3828125, 0.3828125,     0.375,     0.375, 0.3828125, 0.3828125,
  0.3828125,     0.375,     0.375,     0.375,     0.375,     0.375,
  0.3828125,     0.375,     0.375, 0.3828125,     0.375,     0.375,
  0.3828125, 0.3828125,     0.375,     0.375,     0.375,     0.375,
      0.375, 0.3828125, 0.3828125,     0.375,     0.375,     0.375,
      0.375, 0.3828125, 0.3828125, 0.3828125,     0.375, 0.3828125,
  0.3828125,     0.375, 0.3828125, 0.3828125,     0.375,     0.375,
      0.375,     0.375,     0.375, 0.3828125, 0.3828125,     0.375,
      0.375,     0.375,     0.375, 0.3828125, 0.3828125,     0.375,
      0.375,     0.375,     0.375,     0.375
],
[
  0.9296875,    0.8125, 0.9453125,      0.25, 0.9453125, 0.7890625, 0.8984375,
       0.25, 0.5703125,      0.25, 0.7578125, 0.8515625,      0.25, 0.7578125,
       0.25,  0.859375, 0.7890625, 0.9140625,  0.890625, 0.8671875,  0.859375,
       0.25, 0.7890625,  0.859375,  0.828125, 0.8671875, 0.9453125, 0.7890625,
   0.890625,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0,         0,         0,         0,         0,         0,
          0,         0
]
]
for (const test of tests) {
  const t = tf.tensor([test])
  t.print()
  const result = model.predict(t)
  result.print()
}

async function test_model() {
  console.log("evaluating")
  var results = model.evaluate(val_xs, val_ys)
  console.log("Loss:", results[0].arraySync())
  console.log("Acc:", results[1].arraySync())
}


// Train model
async function run() {
  var counter = 0
  console.log("training")
  await model.fit(xs, ys, {
    validationData: (val_xs, val_ys),
    shuffle: true,
    batchSize: 3,
    epochs: 5,
    callbacks: {
      onEpochEnd: (epoch, log) => {
        counter++
        if (counter % 1 == 0) {
          test_model()
          console.log(`Epoch ${epoch}:\taccuracy = ${log.acc}\tloss = ${log.loss}`)
          model.save(`file://./checkpoints/attempt${ATTEMPT}/checkpoint${epoch + 1}`)
        }
      }
    }
  })

  await model.save(`file://./checkpoints/attempt${ATTEMPT}/checkpointDone`)

  test_model()
  const tests = tf.tensor([
  [
     0.765625, 0.8515625,   0.78125,      0.25,   0.78125, 0.828125,    0.9375,
         0.25,  0.609375,      0.25,  0.796875,  0.890625,     0.25,  0.796875,
         0.25, 0.8984375,  0.828125,  0.953125, 0.9296875,  0.90625, 0.8984375,
         0.25,  0.828125, 0.8984375, 0.8671875,   0.90625,  0.78125,  0.828125,
    0.9296875,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0,         0,         0,         0,        0,         0,
            0,         0
  ],
  [
    0.828125,   0.84375, 0.8984375,      0.25,     0.875, 0.8984375,  0.796875,
        0.25,  0.671875,      0.25, 0.7890625, 0.8046875,      0.25,  0.890625,
        0.25,  0.765625,  0.890625,    0.8125,  0.921875, 0.8203125, 0.7890625,
        0.25, 0.8984375, 0.7578125, 0.9296875, 0.8984375, 0.8984375,  0.921875,
    0.796875,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0,         0,         0,         0,         0,         0,
           0,         0
  ],
  [
    0.5859375, 0.6640625,  0.359375,      0.25,  0.046875,  1.046875, 1.8984375,
    1.1796875,   1.40625, 0.4609375, 0.2734375, 0.5390625, 0.5859375,   1.59375,
    1.5234375,  0.890625, 0.8515625,  1.046875,  1.296875, 1.3671875, 1.5859375,
            1, 0.7734375,  1.828125, 0.9609375,  0.609375, 0.3828125, 1.0234375,
    1.3515625,  0.390625, 1.4140625, 0.1328125,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0
  ],
  [
    0.4296875, 0.3828125,  0.765625, 0.3828125,  0.421875, 0.4453125,
     0.765625,  0.765625,     0.375,  0.765625,   0.40625, 0.4140625,
     0.390625, 0.4140625, 0.7890625, 0.3984375,  0.390625,  0.390625,
    0.3828125, 0.4453125, 0.3984375,   0.78125,   0.40625, 0.4140625,
    0.4140625, 0.4140625, 0.4140625, 0.4453125, 0.3984375,  0.765625,
    0.7890625, 0.7890625, 0.3828125,  0.421875, 0.4296875, 0.7734375,
      0.78125, 0.4453125, 0.4453125,  0.421875,  0.421875,   0.40625,
    0.3828125,    0.4375, 0.4140625, 0.3828125,  0.390625,  0.421875,
     0.390625, 0.7734375,  0.390625,  0.421875, 0.7890625,   0.40625,
     0.796875, 0.3828125, 0.4453125,   0.40625,  0.390625,  0.390625,
    0.4140625, 0.4296875,     0.375, 0.4296875,         0,         0,
            0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,
            0,         0,         0,         0
  ],
  [
     0.765625,     0.375,   0.78125, 0.4296875, 0.4296875,     0.375,   0.78125,
      0.40625,    0.4375, 0.7890625,  0.765625, 0.7734375,  0.421875, 0.4296875,
      0.40625, 0.4296875,  0.796875, 0.4296875,  0.796875,   0.40625, 0.4140625,
       0.4375,    0.4375, 0.4140625,     0.375,   0.78125, 0.4296875,  0.390625,
     0.421875,  0.421875,  0.765625, 0.4296875, 0.4140625, 0.7734375, 0.4140625,
    0.4296875,  0.796875,    0.4375,     0.375, 0.7734375,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0
  ],
  [
     0.421875,  0.796875,  0.796875,  0.765625, 0.3984375, 0.3984375,    0.4375,
    0.4453125,   0.78125,  0.390625, 0.4140625, 0.7890625, 0.7734375, 0.4296875,
     0.765625,  0.796875,     0.375, 0.3984375, 0.7890625,     0.375, 0.4296875,
    0.4140625, 0.3984375, 0.7578125, 0.3828125,  0.390625, 0.4296875, 0.4140625,
    0.7890625, 0.3984375,  0.796875,   0.40625,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0
  ],
  [
      0.78125,  0.390625,    0.8125, 0.4140625, 0.5703125,    0.5625,   0.84375,
      0.84375, 0.7734375, 0.9453125,  0.515625,  0.578125, 0.5703125, 0.5546875,
     0.546875,   0.90625, 0.5703125, 0.5546875, 0.5390625, 0.8046875,  0.765625,
    0.8515625,  0.671875, 0.3828125, 0.7734375, 0.8515625, 0.4453125, 0.9140625,
    0.5703125, 0.5546875,  0.671875, 0.9140625, 0.7578125, 0.8515625, 0.4453125,
    0.4140625,  0.703125,    0.6875, 0.5703125, 0.4765625,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0
  ],
  [
       0.6875, 0.3671875,   0.96875, 0.3515625,   0.96875, 0.6953125,     0.25,
    0.6953125, 0.3984375, 0.4140625,      0.25, 0.2578125,      0.25,  0.40625,
      0.96875,  0.671875,   0.96875,      0.25,   0.40625,      0.25,  0.96875,
      0.96875, 0.3984375,    0.3125, 0.7421875, 0.3203125,   0.96875, 0.390625,
        0.375,   0.96875,   0.96875,      0.25, 0.3984375,   0.96875,  0.96875,
     0.578125,     0.375, 0.6953125, 0.3984375,   0.96875,  0.390625,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0,         0,         0,         0,         0,        0,
            0,         0
  ],
  [
     0.359375, 0.3515625, 0.3515625,      0.25,  0.359375,  0.359375,
     0.359375,  0.359375,      0.25, 0.3515625,  0.359375, 0.3515625,
    0.3515625,      0.25, 0.3671875,      0.25, 0.3515625,  0.359375,
    0.3515625, 0.3515625,      0.25,  0.359375,      0.25,  0.359375,
     0.359375,  0.359375,      0.25, 0.3671875,      0.25,  0.359375,
     0.359375,      0.25, 0.3671875,      0.25,  0.359375, 0.3515625,
         0.25, 0.3515625, 0.3515625,      0.25, 0.3671875,      0.25,
     0.359375, 0.3515625,      0.25, 0.3671875,      0.25, 0.3515625,
     0.359375,      0.25,  0.359375,      0.25,  0.359375,  0.359375,
    0.3515625,      0.25,  0.359375, 0.3515625,  0.359375,      0.25,
    0.3515625, 0.3515625, 0.3515625,      0.25, 0.3515625,  0.359375,
         0.25, 0.3671875,      0.25,  0.359375,      0.25, 0.3515625,
     0.359375,      0.25,  0.359375, 0.3515625, 0.3515625, 0.3515625,
         0.25, 0.3515625, 0.3515625, 0.3515625,      0.25, 0.3515625,
     0.359375, 0.3515625, 0.3515625,      0.25,  0.359375,      0.25,
     0.359375, 0.3515625,  0.359375,         0,         0,         0,
            0,         0,         0,         0
  ],
  [
    0.3828125, 0.3828125, 0.3828125,     0.375, 0.3828125, 0.3828125,
    0.3828125, 0.3828125, 0.3828125,     0.375, 0.3828125,     0.375,
        0.375,     0.375, 0.3828125, 0.3828125, 0.3828125, 0.3828125,
        0.375,     0.375, 0.3828125, 0.3828125,     0.375,     0.375,
        0.375,     0.375,     0.375, 0.3828125, 0.3828125, 0.3828125,
    0.3828125,     0.375,     0.375, 0.3828125, 0.3828125, 0.3828125,
        0.375,     0.375, 0.3828125,     0.375, 0.3828125, 0.3828125,
    0.3828125, 0.3828125,     0.375,     0.375, 0.3828125, 0.3828125,
    0.3828125,     0.375,     0.375,     0.375,     0.375,     0.375,
    0.3828125,     0.375,     0.375, 0.3828125,     0.375,     0.375,
    0.3828125, 0.3828125,     0.375,     0.375,     0.375,     0.375,
        0.375, 0.3828125, 0.3828125,     0.375,     0.375,     0.375,
        0.375, 0.3828125, 0.3828125, 0.3828125,     0.375, 0.3828125,
    0.3828125,     0.375, 0.3828125, 0.3828125,     0.375,     0.375,
        0.375,     0.375,     0.375, 0.3828125, 0.3828125,     0.375,
        0.375,     0.375,     0.375, 0.3828125, 0.3828125,     0.375,
        0.375,     0.375,     0.375,     0.375
  ],
  [
    0.9296875,    0.8125, 0.9453125,      0.25, 0.9453125, 0.7890625, 0.8984375,
         0.25, 0.5703125,      0.25, 0.7578125, 0.8515625,      0.25, 0.7578125,
         0.25,  0.859375, 0.7890625, 0.9140625,  0.890625, 0.8671875,  0.859375,
         0.25, 0.7890625,  0.859375,  0.828125, 0.8671875, 0.9453125, 0.7890625,
     0.890625,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0,         0,         0,         0,         0,         0,
            0,         0
  ]
])
  const result = model.predict(tests)
  result.print()
}

test_model()
run()
